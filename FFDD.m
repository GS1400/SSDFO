%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FFDD.m %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% gTp = FFDD(fun,xm,fm,p,hmin,hmax)
% FFDD computes directional derivative g(x)Tp


function gTp = FFDD(fun,xm,fm,p,hmin,hmax)


xm = xm(:); CHG = norm(xm)/norm(p);

if (isnan(CHG)|isinf(CHG)), CHG = sqrt(eps);
else
    CHG = min(hmax,max(hmin,eps*CHG));
end

fplus = fun(xm + CHG*p);
gTp =  (fplus-fm)/(CHG);


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





